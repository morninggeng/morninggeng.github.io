<!DOCTYPE html>
<html lang="zh">
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.3 -->

    <!-- Title -->
    
    <title>
        
            SMTP 发送邮件 | 
        
        morninggeng
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
        <link rel="dns-prefetch" href="https://changyan.sohu.com"/>
    
    
    
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="morninggeng">
    <meta name="description" content="你和你羡慕的人之间也许只差了一个「坚持」">
    <meta name="keywords" content="null,Python">

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/androidmorninggeng.png">
    <link rel="icon" sizes="192x192" href="/img/androidmorninggeng.png">
    <link rel="apple-touch-icon" href="/img/androidmorninggeng.png">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="morninggeng">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://morninggeng.cn">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="SMTP 发送邮件 | morninggeng">
    <meta property="og:description" content="你和你羡慕的人之间也许只差了一个「坚持」">
    <meta property="og:article:tag" content="Python"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #29d;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #29d;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        <!--background-color: #F5F5F5;-->
		background-image: url(https://api.i-meto.com/bing?color=white);
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    
        <script type="text/javascript">
            queue.offer(function(){
                $('body').attr('data-original', 'https://api.i-meto.com/bing?color=white');
            });
        </script>
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1-MIMEText-编辑纯文本邮件"><span class="post-toc-number">1.</span> <span class="post-toc-text">1. MIMEText 编辑纯文本邮件</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-MIMEText-编辑-html-邮件"><span class="post-toc-number">2.</span> <span class="post-toc-text">2. MIMEText 编辑 html 邮件</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-MIMTImage-编辑图片邮件"><span class="post-toc-number">3.</span> <span class="post-toc-text">3. MIMTImage 编辑图片邮件</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#4-MIMEMultipart-编辑带附件邮件"><span class="post-toc-number">4.</span> <span class="post-toc-text">4. MIMEMultipart 编辑带附件邮件</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#5-登陆并发送邮件"><span class="post-toc-number">5.</span> <span class="post-toc-text">5. 登陆并发送邮件</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#6-项目实战"><span class="post-toc-number">6.</span> <span class="post-toc-text">6. 项目实战</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(http://opmd2oxww.bkt.clouddn.com/18-3-20/99536674.jpg)">
    
            <p class="article-headline-p">
                SMTP 发送邮件
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/androidmorninggeng.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>morninggeng</strong>
        <span>3月 23, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Python/">Python</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=SMTP 发送邮件&url=http://morninggeng.cn//2018/03/23/Python-SMTPSendEmail/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=SMTP 发送邮件&url=http://morninggeng.cn//2018/03/23/Python-SMTPSendEmail/index.html&via=morninggeng" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://morninggeng.cn//2018/03/23/Python-SMTPSendEmail/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://morninggeng.cn//2018/03/23/Python-SMTPSendEmail/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <blockquote>
<p>SMTP：是发送邮件的协议，Python 内置对 SMTP 的支持，可以发送纯文本、html和带有附件的邮件。</p>
<p>Python 对 SMTP 的支持有 smtplib 和 email 两个模块，email 负责构造邮件，smtplib 负责发送邮件。</p>
<ol>
<li><p>发送纯文本/ html 邮件</p>
<p>发送纯文本文件或 html 文件时，需要用到 email 的 MIMEText 模块，导入方法为 from email.mime.text improt MIMEText。</p>
<p>构造 MIMEText 对象需要传入三个参数：</p>
<ul>
<li>第一个参数为要发送邮件的内容，必须为 str 格式。</li>
<li>第二个参数为 subtype，传入 plain 为纯文本格式邮件，传入 html 为 html 格式邮件。</li>
<li>第三个参数为编码格式，一般填写 utf-8 保证多语言兼容性。</li>
</ul>
</li>
<li><p>发送带附件邮件</p>
<p>发送纯文本文件或 html 文件时，需要用到 email 的 MIMEMultipart 模块，导入方法为 from email.mime.multipart import MIMEMultipart。</p>
<p>构造 MIMEMultipart 不需要传入参数，要将内容附加到邮件主体中调用 attach() 方法。</p>
</li>
</ol>
</blockquote>
<h5 id="1-MIMEText-编辑纯文本邮件"><a href="#1-MIMEText-编辑纯文本邮件" class="headerlink" title="1. MIMEText 编辑纯文本邮件"></a>1. MIMEText 编辑纯文本邮件</h5><p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;abc.txt&apos;, &apos;r&apos;) as file_read:</span><br><span class="line">	content = file_read.read()</span><br><span class="line">msg_1 = MIMEText(content, &apos;plain&apos;, &apos;utf-8&apos;)</span><br></pre></td></tr></table></figure>
<h5 id="2-MIMEText-编辑-html-邮件"><a href="#2-MIMEText-编辑-html-邮件" class="headerlink" title="2. MIMEText 编辑 html 邮件"></a>2. MIMEText 编辑 html 邮件</h5><p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;abc.html&apos;, &apos;r&apos;) as file_read:</span><br><span class="line">	content = file_read.read()</span><br><span class="line">msg_2 = MIMEText(content, &apos;html&apos;, &apos;utf-8&apos;)</span><br></pre></td></tr></table></figure>
<h5 id="3-MIMTImage-编辑图片邮件"><a href="#3-MIMTImage-编辑图片邮件" class="headerlink" title="3. MIMTImage 编辑图片邮件"></a>3. MIMTImage 编辑图片邮件</h5><p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;1.jpg&apos;, &apos;r&apos;) as file_read:</span><br><span class="line">	content = file_read.read()</span><br><span class="line">msg_3 = MIMEImage(content)</span><br></pre></td></tr></table></figure>
<h5 id="4-MIMEMultipart-编辑带附件邮件"><a href="#4-MIMEMultipart-编辑带附件邮件" class="headerlink" title="4. MIMEMultipart 编辑带附件邮件"></a>4. MIMEMultipart 编辑带附件邮件</h5><p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 构建邮件信息</span><br><span class="line">message = MIMEMultipart()</span><br><span class="line">message[&apos;From&apos;] = &apos;发件箱地址&apos;</span><br><span class="line">message[&apos;To&apos;] = &apos;收件箱地址&apos;</span><br><span class="line">message[&apos;Subject&apos;] = Header(&apos;邮件主题&apos;, &apos;utf-8&apos;).encode()</span><br><span class="line"></span><br><span class="line"># 将内容附加到邮件主体中</span><br><span class="line">message.attch(msg_1)</span><br><span class="line">message.attch(msg_2)</span><br><span class="line">message.attch(msg_3)</span><br></pre></td></tr></table></figure>
<h5 id="5-登陆并发送邮件"><a href="#5-登陆并发送邮件" class="headerlink" title="5. 登陆并发送邮件"></a>5. 登陆并发送邮件</h5><p>实践出真知，我们结合一个小场景理解一下该过程：登录 163 邮箱向 qq 邮箱发送邮件。</p>
<p>代码实现分为三个步骤：</p>
<ul>
<li><p>设置好服务器端信息</p>
<p>smtplib.SMTP(‘服务器地址’, 服务器端口号)</p>
</li>
<li><p>邮件主体信息</p>
<p>login() 登录 smtp 邮箱服务器</p>
</li>
<li><p>发送邮件</p>
<p>sendmail() 发送邮件，需要传入三个参数</p>
<p>参数一：发件箱 参数二：收件箱（注意需要[]包裹，这意味着你可以写多个邮件地址群发） 参数三：邮件正文信息</p>
</li>
</ul>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 设置登录及服务器信息</span><br><span class="line"># SMTP 服务器地址 163为例</span><br><span class="line">smtp_server = &apos;smtp.163.com&apos;</span><br><span class="line"># 邮箱登录用户名</span><br><span class="line">login_mail_user = &apos;XXXX&apos;</span><br><span class="line"># 邮箱登录密码</span><br><span class="line">login_mail_pass = &apos;XXXX&apos;</span><br><span class="line"># 发件箱</span><br><span class="line">from_mail = &apos;XXXX@163.com&apos;</span><br><span class="line"># 收件箱</span><br><span class="line">to_mail = [&apos;XXXX@qq.com&apos;, ...]</span><br><span class="line"></span><br><span class="line"># 获取服务器</span><br><span class="line"># 网易 163 为例，端口号为 25</span><br><span class="line">smtp = smtplib.SMTP(smtp_server, 25)</span><br><span class="line"># 登陆邮箱</span><br><span class="line">smtp.login(login_mail_user, login_mail_pass)</span><br><span class="line"></span><br><span class="line"># 发送邮件 </span><br><span class="line">smtp.sendmail(from_mail, to_mail, message.as_string())</span><br><span class="line"># 发送完毕，退出服务器</span><br><span class="line">smtp.quit()</span><br></pre></td></tr></table></figure>
<h5 id="6-项目实战"><a href="#6-项目实战" class="headerlink" title="6. 项目实战"></a>6. 项目实战</h5><p>需求：</p>
<ol>
<li>爬取百度首页 html 源代码</li>
<li>将源代码分别保存为 abc.txt 和 abc.html 文件到本地</li>
<li>将 abc.txt 和 abc.html 和本地 1.jpg 图片作为附件发送到指定邮箱内</li>
</ol>
<p>项目代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">from email.mime.image import MIMEImage</span><br><span class="line">from email.mime.multipart import MIMEMultipart</span><br><span class="line">import smtplib</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 爬取百度首页源码</span><br><span class="line">response = requests.get(&apos;http://www.baidu.com&apos;)</span><br><span class="line">response.encoding = &apos;utf-8&apos;</span><br><span class="line"></span><br><span class="line">with open(&apos;abc.html&apos;, &apos;w&apos;) as file_read:</span><br><span class="line">    file_read.write(response.text)</span><br><span class="line"></span><br><span class="line">with open(&apos;abc.txt&apos;, &apos;w&apos;) as file_read:</span><br><span class="line">    file_read.write(response.text)</span><br><span class="line"></span><br><span class="line"># 设置登录及服务器信息</span><br><span class="line">mail_host = &apos;smtp.163.com&apos;</span><br><span class="line">mail_user = &apos;XXX&apos;</span><br><span class="line">mail_pass = &apos;XXX&apos;</span><br><span class="line">sender = &apos;XXX@163.com&apos;</span><br><span class="line">receivers = [&apos;XXX@qq.com&apos;]</span><br><span class="line"></span><br><span class="line"># 设置eamil信息</span><br><span class="line"># 添加一个MIMEmultipart类，处理正文及附件</span><br><span class="line">message = MIMEMultipart()</span><br><span class="line">message[&apos;From&apos;] = sender</span><br><span class="line">message[&apos;To&apos;] = receivers[0]</span><br><span class="line">message[&apos;Subject&apos;] = &apos;title&apos;</span><br><span class="line"></span><br><span class="line"># 推荐使用 html 格式的正文内容，这样比较灵活，可以附加图片地址，调整格式等</span><br><span class="line">with open(&apos;abc.html&apos;, &apos;r&apos;) as f:</span><br><span class="line">    content = f.read()</span><br><span class="line"># 设置html格式参数</span><br><span class="line">part1 = MIMEText(content, &apos;html&apos;, &apos;utf-8&apos;)</span><br><span class="line"></span><br><span class="line"># 添加一个txt文本附件</span><br><span class="line">with open(&apos;abc.txt&apos;, &apos;r&apos;)as h:</span><br><span class="line">    content2 = h.read()</span><br><span class="line"># 设置txt参数</span><br><span class="line">part2 = MIMEText(content2, &apos;plain&apos;, &apos;utf-8&apos;)</span><br><span class="line"># 附件设置内容类型，方便起见，设置为二进制流</span><br><span class="line">part2[&apos;Content-Type&apos;] = &apos;application/octet-stream&apos;</span><br><span class="line"># 设置附件头，添加文件名</span><br><span class="line">part2[&apos;Content-Disposition&apos;] = &apos;attachment;filename=&quot;abc.txt&quot;&apos;</span><br><span class="line"></span><br><span class="line"># 添加照片附件</span><br><span class="line">with open(&apos;1.jpg&apos;, &apos;rb&apos;)as fp:</span><br><span class="line">    picture = MIMEImage(fp.read())</span><br><span class="line">    # 与txt文件设置相似</span><br><span class="line">    picture[&apos;Content-Type&apos;] = &apos;application/octet-stream&apos;</span><br><span class="line">    picture[&apos;Content-Disposition&apos;] = &apos;attachment;filename=&quot;1.jpg&quot;&apos;</span><br><span class="line"></span><br><span class="line"># 将内容附加到邮件主体中</span><br><span class="line">message.attach(part1)</span><br><span class="line">message.attach(part2)</span><br><span class="line">message.attach(picture)</span><br><span class="line"></span><br><span class="line"># 登录并发送</span><br><span class="line">try:</span><br><span class="line">    smtpObj = smtplib.SMTP(mail_host, 25)</span><br><span class="line">    # smtpObj.connect()</span><br><span class="line">    smtpObj.login(mail_user, mail_pass)</span><br><span class="line">    smtpObj.sendmail(</span><br><span class="line">        sender, receivers, message.as_string())</span><br><span class="line">    print(&apos;success&apos;)</span><br><span class="line">    smtpObj.quit()</span><br><span class="line">except smtplib.SMTPException as e:</span><br><span class="line">    print(&apos;error&apos;, e)</span><br></pre></td></tr></table></figure>
<p><strong>原创不易，请尊重他人的劳动成果，欢迎转载，但请注明出处。</strong></p>
<hr>
<p>morninggeng</p>
<p>03/23/2018</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    


    <!-- 使用 changyan -->
    <div id="changyan-comment">
        <!--PC和WAP自适应版-->
<div id="SOHUCS" sid="2018/03/23/Python-SMTPSendEmail/"  ></div>
<script type="text/javascript">
(function(){
var appid = 'cyt3rd4GP';
var conf = '19d9568ec935e313a737aa1c3f7e35dd';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

    </div>
    <style>
        #changyan-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>






                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/03/23/Python-lxmlCrawlDouBanBook/" id="post_nav-older" class="next-content">
            新篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/daily_pic.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/androidmorninggeng.png" alt="morninggeng's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        morninggeng@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: morninggeng@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">12</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Android/">Android<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/Python/">Python<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/工具/">工具<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="关于">
                
                    <i class="material-icons sidebar-material-icons">person pin</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="链接">
                
                    <i class="material-icons sidebar-material-icons">link</i>
                
                链接
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">loyalty</i>
                
                标签
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/morninggeng" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.svg);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/weiming.geng" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.svg);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.svg);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="http://github.com/morninggeng" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.svg);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;morninggeng
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script src="/js/smoothscroll.js"></script>
    








    <!-- 畅言公共 js 代码 start -->
		<script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cyt3rd4GP">
</script>
    <!-- 畅言公共 js 代码 end -->







<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setTimeout(function(){
            setInterval(function(){
                queue.execNext();
            },200);
        },3000);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
